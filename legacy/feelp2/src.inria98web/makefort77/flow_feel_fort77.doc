feel fort77 プログラム流れ

feel_main
 |
 | パラメータ宣言
 | 配列feel宣言
 | 
 | np_heap に パラメータ、MAX_FEELを代入
 |
 |-- filset  入出力関係ファイルのOPENとファイル装置番号の設定
 |    | io_in      10 入力ファイル
 |    | io_out     11 出力ファイル
 |    | io_stderr   7 標準エラー出力用
 |    | io_elem    io_out+1〜
 |    | io_node    io_elem+MAX_ELEMG〜
 |    | io_num     io_node+MAX_NODESET〜
 |    | io_fem     io_num+MAX_NUMSET〜
 |
 |-- datinp  入力ファイルより各種データの入力
 |    |     (np_workは、節点座標の直ぐ後から始める)
 |    |
 |    | ndim,npmax,nelemg,nodeset,numsetの入力(5I8)
 |    | 次元、節点数、要素グループ数,節点集合数、数値データグループ数
 |    |
 |    | nvars_fem,nvars_ewiseの入力(2I8)
 |    | fem変数の数、ewise変数の数
 |    |
 |    | 各ewise変数の規定値の入力(nvars_ewiseだけ繰り返し)
 |    | 関連する領域の数、各領域番号
 |    |
 |    ||-dat_node1,dat_node2,dat_node3 節点データの入力
 |    ||-dat_elem                      要素データの入力
 |    ||-dat_nodeset                   節点集合データの入力
 |    ||-dat_num                       数値データの入力
 |    ||-dat_comt                      コメントの入力
 |    |
 |
 |-- dat_check  
 |    | データのチェック
 |    |
 |    | ewiseについて
 |    |  各サブ領域の大きさが０で無いかどうか調べる
 |    |
 |
 |-- dat_manage
 |    |
 |
 | fem変数の領域取得    fem変数の先頭アドレスは
 | ewise変数の領域取得
 |

各schemeブロックの実現

【goto文】
【while文】
【if文】
【let文】
1)double,int 変数への代入はメインルーチン上に直接実現する

2)fem変数への代入

    a)fem変数 ＝ ρ(fem変数,スカラー変数,空間変数)
      節点毎の代入文をループで回す処理
      ※エルミート要素の場合どうするか？

    b)fem変数への代入文中、右辺にはewise変数は認められない。
      通常、solve文によって実行されるべきもの
      solve [u] { eq: u = ewise_var; なることが出来るか？ }

    c)部分節点に対する代入処理
      a)のループの対象が節点集合データのみとなる他はa)と同根

3)ewise変数への代入

    a)ewise変数 = ρ(fem変数,fem変数に対する微分作用素,空間変数,material変数)

2),3)ともスカラー定数値の代入は問題なし

【solve文】

数値積分型(アイソパラメトリック、サブパラメトリック要素など)

main routine
 |
〜
 |
 |-- solve0?()   引き数は、配列feelのパラメータ及び、ワーク領域への引き数
 |    |
 |    | 累積節点自由度配列IPD(＊)のメモリ取得と初期化
 |    | 
 |    |
 |    ||要素グループに関するループ
 |    ||
 |    ||
 |    ||
 |    ||- 各要素グループでの累積節点自由度カウントプログラムの呼びだし
 |    ||○スカイライン法の為の情報配列 (→セーブ対象)
 |    ||  累積節点自由度、節点無し自由度の為の情報配列
 |    ||  累積節点自由度の計算
 |    ||
 |    ||- 各要素データの読み込み
 |    ||- 節点自由度の計算
 |    ||
 |    |
 |    | 累積節点自由度の計算
 |    ||要素グループに関するループ
 |    ||
 |    ||- 節点無し自由度に対する方程式番号情報配列の作成
 |    |
 |    | 配列KLDの作成
 |    |
 |    | 
 |    | ○要素指向座標配列の作成       (→セーブ対象)
 |    | 
 |    | スカイライン法に関する配列領域の取得、初期化
 |    |
 |    ||要素グループに関するループ
 |    ||
 |    ||○配列の割り当て
 |    ||   (数値積分点、重み、形状関数の数値積分点での値 
 |    ||   (要素内小行列の領域取得)
 |    ||
 |    ||--form??_? 要素単位の連立一次方程式係数組み合わせプログラム
 |    ||   |
 |    ||   |- form??_?jset 形状関数の各積分点での計算式
 |    ||   |
 |    ||   |- elem??_? 要素小行列、要素右辺ベクトルの作成
 |    ||   |
 |    ||   |- 全体行列、全体右辺ベクトルへの足し合わせ
 |    ||   |
 |    ||
 |    |
 |    ||- dbc0? ノイマン条件処理
 |    |
 |    ||- nbc0? ディリクレ条件処理
 |    |
 |    |- 連立一次方程式呼び出し
 |    |- 結果の各fem変数配列への分配
 |
 |
 |
【nonlinear文】






