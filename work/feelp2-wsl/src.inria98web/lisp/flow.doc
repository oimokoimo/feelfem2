有限要素法の為の要素小行列式計算アルゴリズム

【数値積分版】

弱形式の作成(境界積分項の分離)

(+ (* (dx u)(dx $)) (* (dy u)(dy $)))

【C側の処理(準備)】
未知fem変数リスト、既知fem変数リスト、ewise変数リスト、
double変数リスト、const変数リストの作成

試験関数リストの作成

未知変数の置換式の算出
未知変数に関する関数リストの作成

P1_1,P1_2,P1_3など、各基底関数シンボルの作成とリストの作成(r,s式)
サブindexは、局所節点番号

u -> (+ (* M1 P1_1) (* M2 P1_2) (* M3 P1_3))


【LISPによる処理】
各行の作成             symbol-eval-replace関数
各成分の抽出           
非線形処理

微分作用素を含む項の洗いだし

プログラム生成
 要素プログラム
 数値積分補助プログラム
 
【呼び出し形式】
要素ルーチンの呼び出し引き数

x,y,z         節点座標                   x_1,x_2,x_3,y_1,y_2,y_3等
                節点座標は全ての節点値について引き数に登録
  	        番号は一意に定まる局所節点番号を用いる   

              スカラー変数(既知)         db_a,db_b等

              fem変数
                fem_u_1 など  この番号は局所節点番号を用いる      

              ewise変数
                ew_oimo_1 など


