%-------- First font variable ------------------------------
/Font00 /Times-Roman findfont 10 scalefont def
%-------- Default font set ---------------------------------
Font00 setfont
%-------- Define variables ---------------------------------
/Xpos 0 def   
/Ypos 0 def
/Dxpos 0 def
/Dypos 0 def
%-------- Define procedure for saving file size ------------
/N { newpath } def
/MT { moveto } def
/LT { lineto } def
/ST { stroke } def
%-------- show string migi zume  Tutorial p.42 -------------
/RightShow
{ dup stringwidth pop
  4 -1 roll exch sub 
  3 -1 roll moveto
  show } def
/MiddleShow
{ dup stringwidth pop
  2 div
  4 -1 roll exch sub
  3 -1 roll moveto
  show } def
/SupShow
{ /Fontsize exch def 
  4 -1 roll
  dup /Xpos exch def
  4 -1 roll
  dup /Ypos exch def
  moveto
  exch dup stringwidth
  2 div
  Ypos add Fontsize 0.8 mul add /Ypos exch def
  Xpos add /Xpos exch def
  show
  Xpos Ypos moveto
  0.5 0.5 scale show
  2.0 2.0 scale } def

/SupMiddleShow
{ /Fontsize exch def
  4 -1 roll
  /Xpos exch def
  3 -1 roll
  /Ypos exch def
  exch dup stringwidth
  /Dypos exch def
  2 div /Dxpos exch def
  Xpos Dxpos sub
  Ypos 
  moveto
  show
  Xpos Dxpos add
  Ypos Dypos add Fontsize 0.8 mul add moveto
  0.5 0.5 scale show
  2.0 2.0 scale } def

/SupRightShow
{ /Fontsize exch def
  4 -1 roll
  /Xpos exch def
  3 -1 roll
  /Ypos exch def
  exch dup stringwidth
  2 div /Dypos exch def
  /Dxpos exch def
  Xpos Dxpos sub 
  Ypos moveto
  show
  Xpos
  Ypos Dypos add Fontsize 0.8 mul add
  moveto
  0.5 0.5 scale show
  2.0 2.0 scale } def

%------------Centered Dash Patterns  CookBook p.141 --------------

/centerdash
{ /pattern exch def
  /pathlen pathlength def
  /patternlength 0 def
  pattern
  { patternlength add /patternlength exch def
  } forall

  pattern length 2 mod 0 ne
   { /patternlength patternlength 2 mul def } if

   /first pattern 0 get def

   /last patternlength first sub def

   /n pathlen last sub patternlength idiv def
   /endpart pathlen patternlength n mul sub
    last sub 2 div def

   /offset first endpart sub def

   pattern offset setdash
   } def

/pathlength
{ flattenpath
  /dist 0 def

  { /yfirst exch def /xfirst exch def
    /ymoveto yfirst def /xmoveto xfirst def }
  { /ynext exch def /xnext exch def
    /dist dist ynext yfirst sub dup mul
    xnext xfirst sub dup mul add sqrt add def
    /yfirst  ynext def /xfirst xnext def }
    {}

   {/ynext ymoveto def /xnext xmoveto def
    /dist dist ynext yfirst sub dup mul
      xnext xfirst sub dup mul add sqrt add def
    /yfirst ynext def /xfirst xnext def}
    pathforall
    dist
   } def
%-------- End of Pre definitions ---------------------------  
